2024-02-22 17:45:23,959 INFO    MainThread:11211 [wandb_setup.py:_flush():76] Current SDK version is 0.16.3
2024-02-22 17:45:23,959 INFO    MainThread:11211 [wandb_setup.py:_flush():76] Configure stats pid to 11211
2024-02-22 17:45:23,959 INFO    MainThread:11211 [wandb_setup.py:_flush():76] Loading settings from /home/less/.config/wandb/settings
2024-02-22 17:45:23,959 INFO    MainThread:11211 [wandb_setup.py:_flush():76] Loading settings from /data/users/less/local/OLMo/wandb/settings
2024-02-22 17:45:23,959 INFO    MainThread:11211 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-02-22 17:45:23,959 INFO    MainThread:11211 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-02-22 17:45:23,959 INFO    MainThread:11211 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'scripts/train.py', 'program_abspath': '/data/users/less/local/OLMo/scripts/train.py', 'program': '/data/users/less/local/OLMo/scripts/train.py'}
2024-02-22 17:45:23,959 INFO    MainThread:11211 [wandb_init.py:_log_setup():526] Logging user logs to OLMo-1B/wandb/wandb/run-20240222_174523-tewazdkc/logs/debug.log
2024-02-22 17:45:23,959 INFO    MainThread:11211 [wandb_init.py:_log_setup():527] Logging internal logs to OLMo-1B/wandb/wandb/run-20240222_174523-tewazdkc/logs/debug-internal.log
2024-02-22 17:45:23,959 INFO    MainThread:11211 [wandb_init.py:init():566] calling init triggers
2024-02-22 17:45:23,959 INFO    MainThread:11211 [wandb_init.py:init():573] wandb.init called with sweep_config: {}
config: {'run_name': 'OLMo-1B', 'seed': 6198, 'epoch': None, 'dry_run': False, 'model': {'d_model': 2048, 'n_heads': 16, 'n_layers': 16, 'mlp_ratio': 8, 'mlp_hidden_size': None, 'activation_type': 'swiglu', 'block_type': 'sequential', 'block_group_size': 1, 'alibi': False, 'alibi_bias_max': 8.0, 'rope': True, 'rope_full_precision': True, 'flash_attention': False, 'attention_dropout': 0.0, 'multi_query_attention': False, 'attention_layer_norm': False, 'residual_dropout': 0.0, 'embedding_dropout': 0.0, 'layer_norm_type': 'default', 'layer_norm_with_affine': False, 'attention_layer_norm_with_affine': False, 'max_sequence_length': 2048, 'include_bias': False, 'bias_for_layer_norm': False, 'scale_logits': False, 'vocab_size': 50280, 'embedding_size': 50304, 'weight_tying': True, 'eos_token_id': 50279, 'pad_token_id': 1, 'init_device': 'meta', 'init_fn': 'mitchell', 'init_std': 0.02, 'init_cutoff_factor': None, 'precision': 'amp_bf16'}, 'optimizer': {'name': 'adamw', 'learning_rate': 0.0004, 'weight_decay': 0.1, 'betas': (0.9, 0.95), 'no_decay_norm_and_bias': None, 'decay_norm_and_bias': False, 'decay_embeddings': False, 'metrics_log_interval': 10}, 'scheduler': {'name': 'cosine_with_warmup', 'units': 'steps', 't_warmup': 2000, 't_max': None, 'alpha_f': 0.1, 'grad_clip_warmup_steps': None, 'grad_clip_warmup_factor': None}, 'data': {'paths': ['https://olmo-data.org/preprocessed/olmo-mix/v1_5/gpt-neox-20b-pii-special/part-000-00000.npy', 'https://olmo-data.org/preprocessed/olmo-mix/v1_5/gpt-neox-20b-pii-special/part-000-00001.npy', 'https://olmo-data.org/preprocessed/olmo-mix/v1_5/gpt-neox-20b-pii-special/part-001-00000.npy', 'https://olmo-data.org/preprocessed/olmo-mix/v1_5/gpt-neox-20b-pii-special/part-002-00000.npy', 'https://olmo-data.org/preprocessed/olmo-mix/v1_5/gpt-neox-20b-pii-special/part-003-00000.npy', 'https://olmo-data.org/preprocessed/olmo-mix/v1_5/gpt-neox-20b-pii-special/part-004-00000.npy'], 'datasets': None, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': True, 'pin_memory': True, 'prefetch_factor': 16, 'persistent_workers': True, 'timeout': 0}, 'restore_dataloader': True, 'fast_forward_batches': None, 'evaluators': [{'label': 'v3-small-ppl-validation', 'type': 'lm', 'data': {'paths': None, 'datasets': {'v3-small-c4_en-validation': ['https://olmo-data.org/eval-data/perplexity/v3_small_gptneox20b/c4_en/val/part-0-00000.npy'], 'v3-small-dolma_books-validation': ['https://olmo-data.org/eval-data/perplexity/v3_small_gptneox20b/dolma_books/val/part-0-00000.npy'], 'v3-small-dolma_common-crawl-validation': ['https://olmo-data.org/eval-data/perplexity/v3_small_gptneox20b/dolma_common-crawl/val/part-0-00000.npy'], 'v3-small-dolma_pes2o-validation': ['https://olmo-data.org/eval-data/perplexity/v3_small_gptneox20b/dolma_pes2o/val/part-0-00000.npy'], 'v3-small-dolma_reddit-validation': ['https://olmo-data.org/eval-data/perplexity/v3_small_gptneox20b/dolma_reddit/val/part-0-00000.npy'], 'v3-small-dolma_stack-validation': ['https://olmo-data.org/eval-data/perplexity/v3_small_gptneox20b/dolma_stack/val/part-0-00000.npy'], 'v3-small-dolma_wiki-validation': ['https://olmo-data.org/eval-data/perplexity/v3_small_gptneox20b/dolma_wiki/val/part-0-00000.npy'], 'v3-small-ice-validation': ['https://olmo-data.org/eval-data/perplexity/v3_small_gptneox20b/ice/val/part-0-00000.npy'], 'v3-small-m2d2_s2orc-validation': ['https://olmo-data.org/eval-data/perplexity/v3_small_gptneox20b/m2d2_s2orc/val/part-0-00000.npy'], 'v3-small-pile-validation': ['https://olmo-data.org/eval-data/perplexity/v3_small_gptneox20b/pile/val/part-0-00000.npy'], 'v3-small-wikitext_103-validation': ['https://olmo-data.org/eval-data/perplexity/v3_small_gptneox20b/wikitext_103/val/part-0-00000.npy']}, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': True, 'pin_memory': False, 'prefetch_factor': None, 'persistent_workers': False, 'timeout': 0}, 'device_eval_batch_size': None, 'subset_num_batches': None}, {'label': 'v2-small-ppl-validation', 'type': 'lm', 'data': {'paths': None, 'datasets': {'v2-small-4chan-validation': ['https://olmo-data.org/eval-data/perplexity/v2_small_gptneox20b/4chan/val.npy'], 'v2-small-c4_100_domains-validation': ['https://olmo-data.org/eval-data/perplexity/v2_small_gptneox20b/c4_100_domains/val.npy'], 'v2-small-c4_en-validation': ['https://olmo-data.org/eval-data/perplexity/v2_small_gptneox20b/c4_en/val.npy'], 'v2-small-gab-validation': ['https://olmo-data.org/eval-data/perplexity/v2_small_gptneox20b/gab/val.npy'], 'v2-small-ice-validation': ['https://olmo-data.org/eval-data/perplexity/v2_small_gptneox20b/ice/val.npy'], 'v2-small-m2d2_s2orc-validation': ['https://olmo-data.org/eval-data/perplexity/v2_small_gptneox20b/m2d2_s2orc/val.npy'], 'v2-small-m2d2_wiki-validation': ['https://olmo-data.org/eval-data/perplexity/v2_small_gptneox20b/m2d2_wiki/val.npy'], 'v2-small-manosphere-validation': ['https://olmo-data.org/eval-data/perplexity/v2_small_gptneox20b/manosphere/val.npy'], 'v2-small-mc4_en-validation': ['https://olmo-data.org/eval-data/perplexity/v2_small_gptneox20b/mc4_en/val.npy'], 'v2-small-pile-validation': ['https://olmo-data.org/eval-data/perplexity/v2_small_gptneox20b/pile/val.npy'], 'v2-small-ptb-validation': ['https://olmo-data.org/eval-data/perplexity/v2_small_gptneox20b/ptb/val.npy'], 'v2-small-twitterAEE-validation': ['https://olmo-data.org/eval-data/perplexity/v2_small_gptneox20b/twitterAEE/val.npy'], 'v2-small-wikitext_103-validation': ['https://olmo-data.org/eval-data/perplexity/v2_small_gptneox20b/wikitext_103/val.npy']}, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': True, 'pin_memory': False, 'prefetch_factor': None, 'persistent_workers': False, 'timeout': 0}, 'device_eval_batch_size': None, 'subset_num_batches': None}, {'label': 'piqa', 'type': 'downstream', 'data': {'paths': None, 'datasets': None, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': False, 'pin_memory': False, 'prefetch_factor': None, 'persistent_workers': False, 'timeout': 0}, 'device_eval_batch_size': None, 'subset_num_batches': None}, {'label': 'hellaswag', 'type': 'downstream', 'data': {'paths': None, 'datasets': None, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': False, 'pin_memory': False, 'prefetch_factor': None, 'persistent_workers': False, 'timeout': 0}, 'device_eval_batch_size': None, 'subset_num_batches': None}, {'label': 'winogrande', 'type': 'downstream', 'data': {'paths': None, 'datasets': None, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': False, 'pin_memory': False, 'prefetch_factor': None, 'persistent_workers': False, 'timeout': 0}, 'device_eval_batch_size': None, 'subset_num_batches': None}, {'label': 'openbook_qa', 'type': 'downstream', 'data': {'paths': None, 'datasets': None, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': False, 'pin_memory': False, 'prefetch_factor': None, 'persistent_workers': False, 'timeout': 0}, 'device_eval_batch_size': None, 'subset_num_batches': None}, {'label': 'sciq', 'type': 'downstream', 'data': {'paths': None, 'datasets': None, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': False, 'pin_memory': False, 'prefetch_factor': None, 'persistent_workers': False, 'timeout': 0}, 'device_eval_batch_size': None, 'subset_num_batches': None}, {'label': 'arc_easy', 'type': 'downstream', 'data': {'paths': None, 'datasets': None, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': False, 'pin_memory': False, 'prefetch_factor': None, 'persistent_workers': False, 'timeout': 0}, 'device_eval_batch_size': None, 'subset_num_batches': None}, {'label': 'copa', 'type': 'downstream', 'data': {'paths': None, 'datasets': None, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': False, 'pin_memory': False, 'prefetch_factor': None, 'persistent_workers': False, 'timeout': 0}, 'device_eval_batch_size': None, 'subset_num_batches': None}, {'label': 'rte', 'type': 'downstream', 'data': {'paths': None, 'datasets': None, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': False, 'pin_memory': False, 'prefetch_factor': None, 'persistent_workers': False, 'timeout': 0}, 'device_eval_batch_size': None, 'subset_num_batches': None}, {'label': 'commitment_bank', 'type': 'downstream', 'data': {'paths': None, 'datasets': None, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': False, 'pin_memory': False, 'prefetch_factor': None, 'persistent_workers': False, 'timeout': 0}, 'device_eval_batch_size': None, 'subset_num_batches': None}, {'label': 'mrpc', 'type': 'downstream', 'data': {'paths': None, 'datasets': None, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': False, 'pin_memory': False, 'prefetch_factor': None, 'persistent_workers': False, 'timeout': 0}, 'device_eval_batch_size': None, 'subset_num_batches': None}, {'label': 'sst2', 'type': 'downstream', 'data': {'paths': None, 'datasets': None, 'label_mask_paths': None, 'pad_direction': 'right', 'generate_attention_mask': False, 'num_workers': 0, 'drop_last': False, 'pin_memory': False, 'prefetch_factor': None, 'persistent_workers': False, 'timeout': 0}, 'device_eval_batch_size': None, 'subset_num_batches': None}], 'eval_interval': 1000, 'tokenizer': {'identifier': 'tokenizers/allenai_eleuther-ai-gpt-neox-20b-pii-special.json', 'truncate_direction': 'right'}, 'save_folder': 'OLMo-1B', 'remote_save_folder': None, 'canceled_check_interval': 50, 'save_interval': 1000, 'save_interval_unsharded': 10000, 'save_interval_ephemeral': None, 'save_num_checkpoints_to_keep': 9, 'save_num_unsharded_checkpoints_to_keep': -1, 'save_overwrite': False, 'force_save_unsharded': False, 'no_pre_train_checkpoint': False, 'load_path': None, 'load_path_sharded_checkpointer': None, 'reset_optimizer_state': False, 'reset_trainer_state': False, 'sharded_checkpointer': 'torch_legacy', 'new_style_checkpoints': None, 'max_duration': 739328, 'global_train_batch_size': 2048, 'device_train_batch_size': 256, 'device_train_microbatch_size': 8, 'device_eval_batch_size': 8, 'eval_subset_num_batches': -1, 'eval_on_load': False, 'device_train_grad_accum': 32, 'max_grad_norm': 1.0, 'max_grad_norm_ratio': None, 'precision': 'amp_bf16', 'speed_monitor': {'window_size': 20, 'gpu_flops_available': None}, 'console_log_interval': 1, 'compile': None, 'fsdp': {'use_orig_params': True, 'sharding_strategy': <ShardingStrategy.FULL_SHARD: 1>, 'wrapping_strategy': None, 'precision': 'mixed'}, 'softmax_auxiliary_loss': False, 'time_limit': 171000.0, 'extra_steps_after_cancel': 10, 'early_stopping_factor': None, 'save_data_indices': True, 'python_profiling': False, 'torch_profiling': False, 'stop_at': None, 'activation_checkpointing': None}
2024-02-22 17:45:23,959 INFO    MainThread:11211 [wandb_init.py:init():616] starting backend
2024-02-22 17:45:23,959 INFO    MainThread:11211 [wandb_init.py:init():620] setting up manager
2024-02-22 17:45:23,961 INFO    MainThread:11211 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-02-22 17:45:23,962 INFO    MainThread:11211 [wandb_init.py:init():628] backend started and connected
2024-02-22 17:45:23,966 INFO    MainThread:11211 [wandb_init.py:init():720] updated telemetry
2024-02-22 17:45:23,972 INFO    MainThread:11211 [wandb_init.py:init():753] communicating run to backend with 90.0 second timeout
2024-02-22 17:45:24,348 ERROR   MainThread:11211 [wandb_init.py:init():779] encountered error: It appears that you do not have permission to access the requested resource. Please reach out to the project owner to grant you access. If you have the correct permissions, verify that there are no issues with your networking setup.(Error 404: Not Found)
2024-02-22 17:45:24,631 ERROR   MainThread:11211 [wandb_init.py:init():1194] It appears that you do not have permission to access the requested resource. Please reach out to the project owner to grant you access. If you have the correct permissions, verify that there are no issues with your networking setup.(Error 404: Not Found)
Traceback (most recent call last):
  File "/home/less/local/miniconda3/envs/cuda_snow/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1176, in init
    run = wi.init()
  File "/home/less/local/miniconda3/envs/cuda_snow/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 785, in init
    raise error
wandb.errors.CommError: It appears that you do not have permission to access the requested resource. Please reach out to the project owner to grant you access. If you have the correct permissions, verify that there are no issues with your networking setup.(Error 404: Not Found)
2024-02-22 17:45:25,809 WARNING MsgRouterThr:11211 [router.py:message_loop():77] message_loop has been closed
